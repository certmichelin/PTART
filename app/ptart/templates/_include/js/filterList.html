
<script>
const form = document.getElementById('filterForm');
const tableContainer = document.getElementById('tableContainer');
let timer = null;

form.querySelectorAll('input, select').forEach(el => {
    el.addEventListener('input', triggerFilter);
    el.addEventListener('change', triggerFilter);
});

function triggerFilter() {
    clearTimeout(timer);
    timer = setTimeout(applyFilter, 300);
}

function applyFilter() {
    const params = new URLSearchParams(new FormData(form));
    fetch(window.location.pathname + "?" + params.toString(), {
        headers: {"X-Requested-With": "XMLHttpRequest"}
    })
    .then(r => r.json())
    .then(data => {
        tableContainer.innerHTML = data.table_html;
    });
}
</script>